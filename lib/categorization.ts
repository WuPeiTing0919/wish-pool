// å·¥ä½œç—›é»žåˆ†é¡žç³»çµ± - ç²¾ç°¡ç‰ˆ 10 å€‹åˆ†é¡ž
export const categories = [
  {
    name: "é‡è¤‡ä½œæ¥­",
    description: "æ¯å¤©é‡åˆ°éƒ½åœ¨åšçš„é‡å·¥ã€å ±è¡¨ã€é–‹ç¥¨ç­‰ä¾‹è¡Œäº‹å‹™",
    keywords: [
      "é‡è¤‡",
      "é‡å·¥",
      "å ±è¡¨",
      "é–‹ç¥¨",
      "ä¾‹è¡Œ",
      "æ¯å¤©",
      "å›ºå®š",
      "é‡è¤‡æ€§",
      "ä¾‹è¡Œå…¬äº‹",
      "é‡è¤‡å·¥ä½œ",
      "æ—¥å¸¸ä½œæ¥­",
      "å®šæœŸ",
      "é€±æœŸæ€§",
      "é‡è¤‡æ“ä½œ",
      "æ©Ÿæ¢°åŒ–",
      "å–®èª¿",
    ],
    color: "#3B82F6",
    bgColor: "from-blue-500/20 to-blue-600/20",
    borderColor: "border-blue-400/30",
    textColor: "text-blue-200",
    icon: "ðŸ”„",
  },
  {
    name: "æ•¸æ“šæ··äº‚",
    description: "è³‡æ–™çµ±æ•´å›°é›£ã€çˆ†è¡¨ã€ç„¡æ³•åˆ†æžæˆ–è¦–è¦ºåŒ–",
    keywords: [
      "æ•¸æ“š",
      "è³‡æ–™",
      "çµ±æ•´",
      "çˆ†è¡¨",
      "åˆ†æž",
      "è¦–è¦ºåŒ–",
      "æ•´ç†",
      "æ··äº‚",
      "æ•£äº‚",
      "ä¸ä¸€è‡´",
      "æ ¼å¼",
      "åŒ¯å…¥",
      "åŒ¯å‡º",
      "Excel",
      "CSV",
      "å ±å‘Š",
      "åœ–è¡¨",
    ],
    color: "#DB2777",
    bgColor: "from-pink-600/20 to-rose-700/20",
    borderColor: "border-pink-500/30",
    textColor: "text-pink-200",
    icon: "ðŸ“Š",
  },
  {
    name: "æ‰¾ä¸åˆ°è³‡æ–™",
    description: "æ–‡ä»¶ã€SOPã€è¦å‰‡ç­‰è³‡è¨Šé›£æŸ¥æ‰¾",
    keywords: [
      "æ‰¾ä¸åˆ°",
      "æ–‡ä»¶",
      "SOP",
      "è¦å‰‡",
      "è³‡è¨Š",
      "æŸ¥æ‰¾",
      "æœå°‹",
      "æ–‡æª”",
      "æ‰‹å†Š",
      "èªªæ˜Ž",
      "æŒ‡å¼•",
      "æ¨™æº–",
      "ç¨‹åº",
      "çŸ¥è­˜",
      "è³‡æ–™åº«",
      "æª”æ¡ˆ",
      "ä½ç½®",
    ],
    color: "#F59E0B",
    bgColor: "from-yellow-500/20 to-amber-600/20",
    borderColor: "border-yellow-400/30",
    textColor: "text-yellow-200",
    icon: "ðŸ”",
  },
  {
    name: "æµç¨‹å¡é—œ",
    description: "è«‹è³¼ã€æŽ¡è³¼ã€ç¶­ä¿®ç­‰æµç¨‹è¿½è¹¤ä¸åˆ°",
    keywords: [
      "æµç¨‹",
      "è«‹è³¼",
      "æŽ¡è³¼",
      "ç¶­ä¿®",
      "è¿½è¹¤",
      "å¡é—œ",
      "åœæ»¯",
      "å»¶é²",
      "å¯©æ ¸",
      "ç°½æ ¸",
      "ç”³è«‹",
      "é€²åº¦",
      "ç‹€æ…‹",
      "è¿½ä¸åˆ°",
      "ä¸çŸ¥é“",
      "ç­‰å¾…",
    ],
    color: "#EF4444",
    bgColor: "from-red-500/20 to-rose-600/20",
    borderColor: "border-red-400/30",
    textColor: "text-red-200",
    icon: "ðŸš§",
  },
  {
    name: "æ–‡ä»¶å¤ªå¤š",
    description: "è¡¨å–®é‡ã€æœƒè­°ç´€éŒ„ç­‰éœ€äººå·¥è¼¸å…¥/æ¯”å°",
    keywords: [
      "æ–‡ä»¶",
      "è¡¨å–®",
      "æœƒè­°ç´€éŒ„",
      "äººå·¥è¼¸å…¥",
      "æ¯”å°",
      "ç¹ç‘£",
      "å¤ªå¤š",
      "å¤§é‡",
      "æ‰‹å‹•",
      "è¼¸å…¥",
      "å¡«å¯«",
      "ç´™æœ¬",
      "åˆ—å°",
      "æŽƒæ",
      "æ­¸æª”",
      "æ•´ç†",
    ],
    color: "#8B5CF6",
    bgColor: "from-purple-500/20 to-violet-600/20",
    borderColor: "border-purple-400/30",
    textColor: "text-purple-200",
    icon: "ðŸ“„",
  },
  {
    name: "å”ä½œæ··äº‚",
    description: "äººå·¥é…ç½®ã€æ–·ç·šã€è·¨éƒ¨é–€é›£å”èª¿",
    keywords: [
      "å”ä½œ",
      "äººå·¥é…ç½®",
      "æ–·ç·š",
      "è·¨éƒ¨é–€",
      "å”èª¿",
      "æºé€š",
      "é…åˆ",
      "åœ˜éšŠ",
      "åˆä½œ",
      "è¯ç¹«",
      "å›žæ‡‰",
      "è¨Žè«–",
      "æœƒè­°",
      "åŒäº‹",
      "éƒ¨é–€",
      "å”èª¿",
    ],
    color: "#10B981",
    bgColor: "from-green-500/20 to-emerald-600/20",
    borderColor: "border-green-400/30",
    textColor: "text-green-200",
    icon: "ðŸ¤",
  },
  {
    name: "æ™‚é–“æµªè²»",
    description: "ç­‰è³‡æ–™ã€ç­‰ç°½æ ¸ã€ç­‰é–‹æœƒç³»çµ±ç­‰ç„¡æ•ˆçŽ‡æ™‚é–“",
    keywords: [
      "æ™‚é–“",
      "ç­‰è³‡æ–™",
      "ç­‰ç°½æ ¸",
      "ç­‰é–‹æœƒ",
      "ç„¡æ•ˆçŽ‡",
      "æµªè²»",
      "ç­‰å¾…",
      "æ‹–å»¶",
      "æ…¢",
      "æ•ˆçŽ‡",
      "é€Ÿåº¦",
      "åŠ ç­",
      "å¿™ç¢Œ",
      "è¶•å·¥",
      "deadline",
      "æˆªæ­¢",
    ],
    color: "#F97316",
    bgColor: "from-orange-500/20 to-red-600/20",
    borderColor: "border-orange-400/30",
    textColor: "text-orange-200",
    icon: "â°",
  },
  {
    name: "è«®è©¢ç…©é‡",
    description: "å®¢æˆ¶æˆ–å…§éƒ¨å¸¸è¦‹å•ç­”äººåŠ›åƒç·Š",
    keywords: [
      "è«®è©¢",
      "å®¢æˆ¶",
      "å…§éƒ¨",
      "å•ç­”",
      "äººåŠ›åƒç·Š",
      "å¸¸è¦‹å•é¡Œ",
      "é‡è¤‡å•é¡Œ",
      "å®¢æœ",
      "æ”¯æ´",
      "è§£ç­”",
      "å›žè¦†",
      "è©¢å•",
      "ç–‘å•",
      "FAQ",
      "æœå‹™",
      "è™•ç†",
    ],
    color: "#0891B2",
    bgColor: "from-cyan-600/20 to-teal-700/20",
    borderColor: "border-cyan-500/30",
    textColor: "text-cyan-300",
    icon: "ðŸ’¬",
  },
  {
    name: "æ¬Šé™ä¸æ¸…",
    description: "æ¬Šé™ç®¡ç†æ··äº‚ã€è²¬ä»»ä¸æ˜Ž",
    keywords: [
      "æ¬Šé™",
      "ç®¡ç†",
      "æ··äº‚",
      "è²¬ä»»",
      "ä¸æ˜Ž",
      "ä¸æ¸…æ¥š",
      "æŽˆæ¬Š",
      "å­˜å–",
      "å¸³è™Ÿ",
      "å¯†ç¢¼",
      "ç™»å…¥",
      "è§’è‰²",
      "è·è²¬",
      "è² è²¬äºº",
      "æ­¸å±¬",
      "åˆ†å·¥",
    ],
    color: "#84CC16",
    bgColor: "from-lime-500/20 to-green-600/20",
    borderColor: "border-lime-400/30",
    textColor: "text-lime-200",
    icon: "ðŸ”",
  },
  {
    name: "ç³»çµ±å¤ªå¤š",
    description: "å¤šç³»çµ±æ“ä½œã€åˆ‡æ›æˆæœ¬é«˜",
    keywords: [
      "ç³»çµ±",
      "å¤šç³»çµ±",
      "åˆ‡æ›",
      "æˆæœ¬é«˜",
      "å¤ªå¤š",
      "å¤ªé›œ",
      "æ“ä½œ",
      "ä»‹é¢",
      "å¹³å°",
      "å·¥å…·",
      "è»Ÿé«”",
      "æ‡‰ç”¨ç¨‹å¼",
      "ç™»å…¥",
      "å¸³è™Ÿ",
      "æ•´åˆ",
      "çµ±ä¸€",
    ],
    color: "#6366F1",
    bgColor: "from-indigo-500/20 to-purple-600/20",
    borderColor: "border-indigo-400/30",
    textColor: "text-indigo-200",
    icon: "ðŸ’»",
  },
]

export interface Wish {
  id: number
  title: string
  currentPain: string
  expectedSolution: string
  expectedEffect: string
  createdAt: string
}

export interface Category {
  name: string
  description: string
  keywords: string[]
  color: string
  bgColor: string
  borderColor: string
  textColor: string
  icon: string
}

// å¤šæ¨™ç±¤è‡ªå‹•åˆ†é¡žå‡½æ•¸ - æœ€å¤šè¿”å›ž3å€‹
export function categorizeWishMultiple(wish: Wish): Category[] {
  const fullText = `${wish.title} ${wish.currentPain} ${wish.expectedSolution} ${wish.expectedEffect}`.toLowerCase()
  const matchedCategories: Category[] = []

  // æª¢æŸ¥æ¯å€‹åˆ†é¡žï¼Œæ”¶é›†æ‰€æœ‰åŒ¹é…çš„åˆ†é¡ž
  categories.forEach((category) => {
    const matchedKeywords = category.keywords.filter((keyword) => fullText.includes(keyword.toLowerCase()))

    if (matchedKeywords.length > 0) {
      matchedCategories.push({
        ...category,
        matchScore: matchedKeywords.length, // æ·»åŠ åŒ¹é…åˆ†æ•¸
      } as Category & { matchScore: number })
    }
  })

  // å¦‚æžœæœ‰åŒ¹é…çš„åˆ†é¡žï¼ŒæŒ‰åŒ¹é…åˆ†æ•¸æŽ’åºä¸¦è¿”å›žæœ€å¤š3å€‹
  if (matchedCategories.length > 0) {
    return matchedCategories.sort((a, b) => (b as any).matchScore - (a as any).matchScore).slice(0, 3) // æœ€å¤š3å€‹æ¨™ç±¤
  }

  // å¦‚æžœæ²’æœ‰åŒ¹é…åˆ°ä»»ä½•åˆ†é¡žï¼Œè¿”å›žé»˜èªåˆ†é¡ž
  return [
    {
      name: "å…¶ä»–å•é¡Œ",
      description: "æœªèƒ½æ­¸é¡žçš„ç‰¹æ®Šå·¥ä½œå›°æ“¾",
      keywords: [],
      color: "#94A3B8",
      bgColor: "from-slate-400/20 to-slate-500/20",
      borderColor: "border-slate-400/40",
      textColor: "text-slate-200",
      icon: "â“",
    },
  ]
}

// ä¿æŒå‘å¾Œå…¼å®¹çš„å–®ä¸€åˆ†é¡žå‡½æ•¸
export function categorizeWish(wish: Wish): Category {
  const categories = categorizeWishMultiple(wish)
  return categories[0] // è¿”å›žæœ€åŒ¹é…çš„åˆ†é¡ž
}

// ç²å–æ‰€æœ‰é¡˜æœ›çš„åˆ†é¡žçµ±è¨ˆï¼ˆæ”¯æŒå¤šæ¨™ç±¤ï¼‰
export function getCategoryStats(wishes: Wish[]) {
  const stats: { [key: string]: number } = {}

  // åˆå§‹åŒ–çµ±è¨ˆ
  categories.forEach((cat) => {
    stats[cat.name] = 0
  })
  stats["å…¶ä»–å•é¡Œ"] = 0

  // çµ±è¨ˆæ¯å€‹åˆ†é¡žçš„æ•¸é‡ï¼ˆå¤šæ¨™ç±¤è¨ˆç®—ï¼‰
  wishes.forEach((wish) => {
    const wishCategories = categorizeWishMultiple(wish)
    wishCategories.forEach((category) => {
      stats[category.name]++
    })
  })

  return stats
}

// ç²å–åˆ†é¡žçµ±è¨ˆï¼ˆç”¨æ–¼é›·é”åœ–ï¼Œé¿å…é‡è¤‡è¨ˆç®—ï¼‰
export function getCategoryStatsForRadar(wishes: Wish[]) {
  const stats: { [key: string]: number } = {}

  // åˆå§‹åŒ–çµ±è¨ˆ
  categories.forEach((cat) => {
    stats[cat.name] = 0
  })
  stats["å…¶ä»–å•é¡Œ"] = 0

  // çµ±è¨ˆæ¯å€‹åˆ†é¡žçš„æ•¸é‡ï¼ˆæ¯å€‹é¡˜æœ›åªè¨ˆç®—ä¸€æ¬¡ï¼Œå–ä¸»è¦åˆ†é¡žï¼‰
  wishes.forEach((wish) => {
    const primaryCategory = categorizeWish(wish)
    stats[primaryCategory.name]++
  })

  return stats
}
